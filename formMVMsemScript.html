<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Exportação</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
  <style>
    body {
      font-family: 'Helvetica', 'Arial', sans-serif;
    }

    .container {
      margin-top: 20px;
      padding: 30px;
      background-color: #f5f5f5;
      box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .aliguotas {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .aliguotas > div {
      flex: 1 0 50%;
    }

    #container-section, #modal-aereo-section {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Formulário de Exportação</h1>
    <form>
      <!-- Descrição da Mercadoria -->
      <div class="form-group">
        <label for="descricao">Descrição da Mercadoria:</label>
        <input type="text" class="form-control" id="descricao" required>
      </div>

      <!-- Classificação Fiscal-SH/NCM -->
      <div class="form-group">
        <label for="classificacao">Classificação Fiscal-SH/NCM:</label>
        <input type="text" class="form-control" id="classificacao" required>
      </div>

      <!-- Alíquotas -->
      <div class="form-group">
        <label>ALÍQUOTAS:</label>
        <div class="aliguotas">
          <div>
            <label for="ii">II:</label>
            <input type="number" class="form-control" id="ii" min="0" max="100" required>%
          </div>
          <div>
            <label for="pis">PIS:</label>
            <input type="number" class="form-control" id="pis" min="0" max="100" required>%
          </div>
        </div>
        <div class="aliguotas">
          <div>
            <label for="ipi">IPI:</label>
            <input type="number" class="form-control" id="ipi" min="0" max="100" required>%
          </div>
          <div>
            <label for="cofins">COFINS:</label>
            <input type="number" class="form-control" id="cofins" min="0" max="100" required>%
          </div>
          <div>
            <label for="icms">ICMS:</label>
            <input type="number" class="form-control" id="icms" min="0" max="100" required>%
          </div>
        </div>
      </div>

      <!-- Peso Bruto, Quantidade, etc. -->
      <div class="form-group">
        <label for="peso">Peso Bruto (Kgs):</label>
        <input type="number" class="form-control" id="peso" min="0" required>
      </div>

      <div class="form-group">
        <label for="quantidade">Quantidade:</label>
        <input type="number" class="form-control" id="quantidade" min="0" required>
      </div>

      <!-- ... (demais campos) -->

      <!-- Tipo de Acondicionamento -->
      <div class="form-group">
        <label for="acondicionamento">Tipo de Acondicionamento:</label>
        <select class="form-control" id="acondicionamento">
          <option value="">Selecione...</option>
          <option value="sacaria">Sacaria</option>
          <!-- ... (demais opções) -->
          <option value="containers">Containers</option>
        </select>
      </div>

      <!-- Tipo de Container (se Containers for selecionado) -->
      <div id="container-section">
        <label>Tipo de Container:</label>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="container20">
          <label class="form-check-label" for="container20">20</label>
        </div>
        <!-- ... (demais opções de container) -->
        <div id="total-containers">Quantidade Total de Containers: 0</div>
      </div>

      <!-- Modal -->
      <div class="form-group">
        <label>Modal:</label>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="modal" id="aereo" value="aereo">
          <label class="form-check-label" for="aereo">Aéreo</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="modal" id="maritimo" value="maritimo">
          <label class="form-check-label" for="maritimo">Marítimo</label>
        </div>
      </div>

      <!-- Modal Aéreo -->
      <div id="modal-aereo-section">
        <div class="form-group">
          <label for="num-caixas">Quantidade de Caixas:</label>
          <input type="number" class="form-control" id="num-caixas" min="0">
        </div>
        <div id="caixas-section"></div>
      </div>

      <!-- ... (demais campos) -->

      <!-- Porto/Aeroporto de Embarque-País -->
      <div class="form-group">
        <label for="embarque">Porto/Aeroporto de Embarque-País:</label>
        <select class="form-control" id="embarque">
          <option value="">Selecione...</option>
        </select>
      </div>

      <!-- Porto/Aeroporto de Destino-País -->
      <div class="form-group">
        <label for="destino">Porto/Aeroporto de Destino-País:</label>
        <select class="form-control" id="destino">
          <option value="">Selecione...</option>
        </select>
      </div>

      <!-- ... (demais campos) -->

      <!-- Moeda Estrangeira -->
      <div class="form-group">
        <label for="moeda">Moeda Estrangeira:</label>
        <select class="form-control" id="moeda">
          <option value="">Selecione...</option>
        </select>
      </div>

      <!-- Valor da Mercadoria -->
      <div class="form-group">
        <label for="valor">Valor da Mercadoria:</label>
        <input type="number" class="form-control" id="valor" min="0" required>
      </div>

      <!-- Taxa do Dólar -->
      <div class="form-group">
        <label>Taxa do Dólar (Atualizada):</label>
        <input type="text" class="form-control" id="taxa-dolar" readonly>
      </div>

      <!-- Botão Enviar -->
      <button type="submit" class="btn btn-primary">Enviar</button>
    </form>
  </div>

  <!-- Bootstrap JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Máscara para Classificação Fiscal-SH/NCM
    const classificacaoInput = document.getElementById('classificacao');
    classificacaoInput.addEventListener('input', () => {
      classificacaoInput.value = classificacaoInput.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');
    });

    // Exibir/Ocultar campos de container
    const acondicionamentoSelect = document.getElementById('acondicionamento');
    const containerSection = document.getElementById('container-section');
    acondicionamentoSelect.addEventListener('change', () => {
      if (acondicionamentoSelect.value === 'containers') {
        containerSection.style.display = 'block';
      } else {
        containerSection.style.display = 'none';
      }
    });

    // Contador de containers
    const containerInputs = document.querySelectorAll('#container-section input[type="checkbox"]');
    const totalContainers = document.getElementById('total-containers');
    containerInputs.forEach(input => {
      input.addEventListener('change', () => {
        let total = 0;
        containerInputs.forEach(input => {
          if (input.checked) {
            total++;
          }
        });
        totalContainers.textContent = `Quantidade Total de Containers: ${total}`;
      });
    });

    // Exibir/Ocultar seções de modal
    const modalInputs = document.querySelectorAll('input[name="modal"]');
    const modalAereoSection = document.getElementById('modal-aereo-section');
    modalInputs.forEach(input => {
      input.addEventListener('change', () => {
        if (input.value === 'aereo') {
          modalAereoSection.style.display = 'block';
        } else {
          modalAereoSection.style.display = 'none';
        }
      });
    });

    // Gerar campos de dimensões de caixas
    const numCaixasInput = document.getElementById('num-caixas');
    const caixasSection = document.getElementById('caixas-section');
    numCaixasInput.addEventListener('input', () => {
      const numCaixas = parseInt(numCaixasInput.value);
      caixasSection.innerHTML = '';
      for (let i = 1; i <= numCaixas; i++) {
        caixasSection.innerHTML += `
          <div class="form-group">
            <label>CAIXA ${i}:</label>
            <div class="aliguotas">
              <div>
                <label for="altura-${i}">Altura (cm):</label>
                <input type="number" class="form-control" id="altura-${i}" min="0" required>
              </div>
              <div>
                <label for="largura-${i}">Largura (cm):</label>
                <input type="number" class="form-control" id="largura-${i}" min="0" required>
              </div>
              <div>
                <label for="comprimento-${i}">Comprimento (cm):</label>
                <input type="number" class="form-control" id="comprimento-${i}" min="0" required>
              </div>
            </div>
          </div>
        `;
      }
    });

    // Buscar portos/aeroportos (API OpenSky Network)
    const embarqueSelect = document.getElementById('embarque');
    const destinoSelect = document.getElementById('destino');
    fetch('https://opensky-network.github.io/opensky-api/rest/v2/airports.json')
      .then(response => response.json())
      .then(data => {
        data.airports.forEach(airport => {
          const option = document.createElement('option');
          option.value = airport.id;
          option.text = airport.name;
          embarqueSelect.add(option);
          destinoSelect.add(option.cloneNode(true));
        });
      })
      .catch(error => {
        console.error('Erro ao buscar portos/aeroportos:', error);
        alert('Ocorreu um erro ao buscar portos/aeroportos.');
      });

    // Buscar taxa do dólar (API Alpha Vantage)
    const apiKey = 'YOUR_API_KEY'; // Substitua pela sua chave de API
    fetch(`https://www.alphavantage.co/query?function=CURRENCY_EXCHANGE_RATE&from_currency=USD&to_currency=BRL&apikey=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        const exchangeRate = data['Realtime Currency Exchange Rate']['5. Exchange Rate'];
        document.getElementById('taxa-dolar').value = `R$ ${exchangeRate}`;
      })
      .catch(error => {
        console.error('Erro ao buscar taxa do dólar:', error);
        alert('Ocorreu um erro ao buscar a taxa do dólar.');
      });
  </script>
</body>
</html>